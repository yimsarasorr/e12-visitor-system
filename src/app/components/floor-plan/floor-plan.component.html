<div [class.fullscreen]="isFullscreen" class="floor-plan-wrapper">
  <canvas #canvas></canvas>

  <div class="floor-plan-toolbar" (click)="$event.stopPropagation()">
    <div class="toolbar-left">
      <span class="badge">3D FloorPlan</span>
      <div class="toolbar-title" *ngIf="floorData">
        <h3>{{ floorData.floorName || ('ชั้น ' + floorData.floor) }}</h3>
        <p>ภาพรวมผังพื้นที่แบบเรียลไทม์</p>
      </div>
    </div>
    <div class="toolbar-right">
      <div class="toolbar-bubble" *ngIf="interaction.currentZoneId$ | async as zoneId">
        <span class="bubble-label">โซน</span>
        <strong>{{ zoneId }}</strong>
      </div>
      <div class="toolbar-bubble" *ngIf="playerPositionDisplay$ | async as posDisplay">
        <span class="bubble-label">พิกัด</span>
        <strong>{{ posDisplay }}</strong>
      </div>
    </div>
  </div>

  <app-joystick></app-joystick>
</div>

<p-dialog
  header="รายละเอียดพื้นที่"
  [(visible)]="detailDialogVisible"
  (onHide)="interaction.closeDetail()"
  [modal]="true"
  appendTo="body"
  [style]="{ width: '48vw', 'max-width': '520px' }"
  [draggable]="false"
  [resizable]="false"
>
  <div *ngIf="interaction.selectedObject$ | async as selected" class="detail-content" (click)="$event.stopPropagation()">
    <div class="detail-header">
      <div>
        <h3>{{ selected.data?.name || selected.data?.id }}</h3>
        <p class="detail-subtitle">
          {{ getTypeLabel(selected.type) }} • ชั้น {{ selected.data?.floor ?? floorData?.floor }}
        </p>
      </div>
    </div>

    <div class="detail-section">
      <p>โมดูลข้อมูลเชิงลึกกำลังเตรียมความพร้อมสำหรับการเชื่อมต่อฐานข้อมูลย้อนกลับ.</p>
    </div>
  </div>
</p-dialog>

